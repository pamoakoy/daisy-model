;;; test.dai -- Sample file using the Daisy libraries.

;; We try to run the same simulation with two different soil water
;; transport models.

;; Use standard parameterizations.
(input file "tillage.dai")
(input file "crop.dai")
(input file "log.dai")

;; Weather data.
(weather default "weather.dwf")

;; We have some very sandy soil.
(defhorizon top default
  (SOM_fractions 0.66 0.34 [])
  (clay 8.0 [])
  (silt 10.5 [])
  (humus 1.12 [])
  (coarse_sand 63.4 [])
  (fine_sand 16.5 []))

(defhorizon bottom default
  (SOM_fractions 0.66 0.34 [])
  (clay 8.0 [])
  (silt 10.5 [])
  (humus 0.12 [])			;Less humus here.
  (coarse_sand 63.4 [])
  (fine_sand 16.5 []))

;; We build the column from the horizons.
(defcolumn JB1_Andeby default
  (Bioclimate default)
  (Groundwater deep)
  (Soil (horizons (-20 [cm] top) (-2.5 [m] bottom))
	(zplus -2.5 -5 -10 -15 -20
	       -25 -30 -40 -50 -60 -70
	       -80 -90 -100 -125 -150 -175
	       -200 -225 -250 [cm])
	(MaxRootingDepth 60.0 [cm])))

;; Use it.
(column JB1_Andeby)

;; Simulation start date.
(time 1986 12 1 1)

(manager activity
  (wait (at 1987 3 20 1))
  (plowing)
  (wait (at 1987 4 4 1))
  (fertilize mineral 
	     (weight 100.0 [kg N/ha])
	     (NH4_fraction 0.5 []))
  (wait (at 1987 4 5 1))
  (progn 
    (sow "Grass")
    (sow "Spring Barley"))
  (wait (or (crop_ds_after "Spring Barley" 2.0)
	    (at 1987 9 5 1)))
  (harvest "Spring Barley")
  (wait (at 1987 9 8 1))
  (fertilize mineral
	     (weight 80.0 [kg N/ha])
	     (NH4_fraction 0.5 []))
  (wait (at 1987 10 10 1))
  (harvest "Grass"
	   (stub 8.0 [cm])		;Leave 8 cm stub.
	   (stem 1.00 []))	       ;Harvest everything above stub.
  (wait (at 1988 4 1 1))
  (stop))

;; Define a log file format.
(deflog "pond" table
  (where "pond.tab")
  (when hourly)
  (entries (year (path time))
	   (month (path time))
	   (mday (path time))
	   (hour (path time))
	   (number (path column "*" Surface pond)
		   (when hourly)
		   (dimension "mm"))))

;; Create these log files.
(output pond Harvest
	(checkpoint (when (at 1987 8 8 8))))

;;; test.dai ends here.
