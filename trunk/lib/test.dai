;;; test.dai -- Sample file using the Daisy libraries.

;; We try to run the same simulation with two different soil water
;; transport models.

;; Use standard parameterizations.
(input file "tillage.dai")
(input file "crop.dai")
(input file "log.dai")

;; Weather data.
(weather file "weather.clm"
  (DryDeposit (NO3 1.1)			;[kg/ha/year]
	      (NH4 2.2))
  (WetDeposit (NO3 0.6)			;[ppm]
	      (NH4 0.9)))

;; We have some very sandy soil.
(defhorizon top default
  (hydraulic M_vG 
	     (K_sat 19.3)
	     (Theta_res 0.05)
	     (Theta_sat 0.424)
	     (alpha 0.069)
	     (n 1.527))
  (SOM_fractions 0.66 0.34)
  (SOM_C_per_N 11 11)
  (clay 8.0)
  (silt 10.5)
  (humus 1.12)
  (coarse_sand 63.4)
  (fine_sand 16.5))

(defhorizon bottom default
  (hydraulic M_vG 
	     (K_sat 64.08)
	     (Theta_res 0.042)
	     (Theta_sat 0.438)
	     (alpha 0.054)
	     (n 2.416))
  (SOM_fractions 0.66 0.34)
  (SOM_C_per_N 11 11)
  (clay 8.0)
  (silt 10.5)
  (humus 0.12)				;Less humus here.
  (coarse_sand 63.4)
  (fine_sand 16.5))

;; We use this column.
(defcolumn JB1_Andeby default
  (Bioclimate default)
  (Groundwater static)
  (Soil (horizons (-20 top) (-250 bottom))
	(zplus -2.5 -5 -10 -15 -20
	       -25 -30 -40 -50 -60 -70
	       -80 -90 -100 -125 -150 -175
	       -200 -225 -250)
	(MaxRootingDepth 60.0)
	(dispersivity 8.0))
  (SoilWater (h -100.0))
  (SoilNH4 (M 0.5e-6))
  (SoilNO3 (M 3.0e-6))
  (OrganicMatter (initial_SOM   (-20  4.86)
                                (-40  2.92)
                                (-60  1.46)
                                (-80  0.49)
                                (-100 0.16)
                                (-120 0.03))))



;; We specialize the JB1_Andeby column to use Richards
;; equation and linked reservoirs for water transport, respectively.  
(defcolumn JB1_Richards JB1_Andeby
  (SoilWater (UZtop richards)))

(defcolumn JB1_lr JB1_Andeby
  (SoilWater (UZtop lr)))

;; Run simulation with both columns for comparison.
(column JB1_Richards)

;; Simulation start date.
(time 1986 12 1 1)

;; Spring Barley with ley setup.
(manager cond 
  ((at 1987 3 20 1)
   (plowing))
  ((at 1987 4 4 1)
  (fertilize mineral 
	     (weight 100.0)		;kg N/ha
	     (NH4_fraction 0.5)))
  ((at 1987 4 5 1)
   (sow "Cut Grass")
   (sow "Spring Barley"))
  ((at 1987 9 5 1)
   (harvest "Spring Barley")
   (harvest "Cut Grass"
	    (stub 15)			;Leave 15 cm stub.
	    (stem 1.00)))		;Harvest everything above stub.
  ((at 1987 9 8 1)
   (fertilize mineral
	      (weight 80.0)
	      (NH4_fraction 0.5)))
  ((at 1987 10 10 1)
   (harvest "Cut Grass"
	    (stub 8.)			;Leave 08 cm stub.
	    (stem 1.00)))		;Harvest everything above stub.
  ((at 1988 4 1 1)
   (stop)))

(deflog "pond" table1
  (where "pond.tab")
  (when hourly)
  (entries ((path time year))
	   ((path time month))
	   ((path time mday))
	   ((path column "*" Surface pond)
	    (dimension "mm"))))

;; Create these log files.
(output pond Harvest)

;;; test.dai ends here.
